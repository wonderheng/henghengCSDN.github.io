---
layout: post
title: java中的匿名对象及包与代码块
date: 2018-02-20
tag: javaSE学习心得 
---

### 1. 匿名对象
* A:匿名对象的概述
	* 匿名对象是指创建对象时，只有创建对象的语句，却没有把对象地址值赋值给某个变量。
* B:案例

```java
public class Person{
	public void eat(){
		System.out.println();
	}
}

创建一个普通对象
Person p = new Person();
创建一个匿名对象
new Person();
```

* C: 匿名对象的特点
	* a:创建匿名对象直接使用，没有变量名。
		* `new Person().eat()`  //eat方法被一个没有名字的Person对象调用了。
	* b:匿名对象在没有指定其引用变量时，只能使用一次。
		* `new Person().eat();` 创建一个匿名对象，调用eat方法
		* `new Person().eat();` 想再次调用eat方法，重新创建了一个匿名对象		
	* c:匿名对象可以作为方法接收的参数、方法返回值使用

```java
class Demo {
	public static Person getPerson(){
		//普通方式
		//Person p = new Person();	
		//return p;
		
		//匿名对象作为方法返回值
		return new Person(); 
	}
	
	public static void method(Person p){}
}

class Test {
	public static void main(String[] args) {
		//调用getPerson方法，得到一个Person对象
		Person person = Demo.getPerson();
		
		//调用method方法
		Demo.method(person);
		//匿名对象作为方法接收的参数
		Demo.method(new Person());
	}
}
```
		 
### 2. 内部类
* A: 内部类的概述
	* 将类写在其他类的内部，可以写在其他类的成员位置和局部位置，这时写在其他类内部的类就称为内部类。其他类也称为外部类。
* B: 什么时候使用内部类
	* 在描述事物时，若一个事物内部还包含其他可能包含的事物，比如在描述汽车时，汽车中还包含这发动机，这时发动机就可以使用内部类来描述。

```java
class 汽车 { //外部类
	class 发动机 { //内部类
	}
}
```
* C: 内部类的分类
	* 内部类分为成员内部类与局部内部类。
	* 我们定义内部类时，就是一个正常定义类的过程，同样包含各种修饰符、继承与实现关系等。
	* 在内部类中可以直接访问外部类的所有成员。

### 3. 成员内部类的调用格式
* A: 格式
	* 成员内部类，定义在外部类中的成员位置。与类中的成员变量相似，可通过外部类对象进行访问
* B: 定义格式

```java
class 外部类 { 
	修饰符 class 内部类 {
		//其他代码
	}
}
```

* C: 访问方式
	* `外部类名.内部类名 变量名 = new 外部类名().new 内部类名();`

* D: 成员内部类代码演示

```java
class Body {//外部类，身体
	 private boolean life= true; //生命状态
	 public class Heart { //内部类，心脏
		 public void jump() {
			 System.out.println("心脏噗通噗通的跳")
				System.out.println("生命状态" + life); //访问外部类成员变量
		}
	}
}

访问内部类
public static void main(String[] args) {
	//创建内部类对象
	Body.Heart bh = new Body().new Heart();
	//调用内部类中的方法
	bh.jump();
}
```

### 4. 成员内部类的同名变量调用
* A: 代码实现

```java
public class Outer {
	int i  = 1;
	class Inner {
		int i  = 2;
		public void inner(){
			int i = 3;
			System.out.println(Outer.this.i);
		}
	}
}
```
	
### 5. 局部内部类
* A 局部内部类，定义在外部类方法中的局部位置。与访问方法中的局部变量相似，可通过调用方法进行访问.
* B 定义格式

```java
class 外部类 { 
	修饰符 返回值类型 方法名(参数) {
		class 内部类 {
			//其他代码
		}
	}
}
```

* C 访问方式
	* 在外部类方法中，创建内部类对象，进行访问

* D 局部内部类代码演示

```java
class Party {//外部类，聚会
	public void puffBall(){// 吹气球方法
		class Ball {// 内部类，气球
			  public void puff(){
				System.out.println("气球膨胀了");
			  }
		}
		//创建内部类对象，调用puff方法
		new Ball().puff();
	}
}
访问内部类
public static void main(String[] args) {	
	//创建外部类对象
	Party p = new Party();
	//调用外部类中的puffBall方法
	p.puffBall();
}
```

### 6. 匿名内部类
* A: 概述
	* 内部类是为了应对更为复杂的类间关系。
	* 最常用到的内部类就是匿名内部类，它是局部内部类的一种。
	* 定义的匿名内部类有两个含义：
		* 临时定义某一指定类型的子类
		* 定义后即刻创建刚刚定义的这个子类的对象

* B: 本质
	* 匿名内部类的本质是一个实现了接口或继承了某个类的子类匿名对象.
 
* C: 案例

```java
public interface Smoking {
	public abstract void smoking();
	}
	/*
	 *  实现类,实现接口 重写接口抽象方法,创建实现类对象
	 *  class XXX implements Smoking{
	 *      public void smoking(){
	 *      
	 *      }
	 *  }
	 *  XXX x = new XXX();
	 *  x.smoking(); 
	 *  Smoking s = new XXX();
	 *  s.smoking();
	 *  
	 *  匿名内部类,简化问题:  定义实现类,重写方法,建立实现类对象,合为一步完成
	 */

测试类:
public class Test {
	public static void main(String[] args) {
		//使用匿名内部类
		/*
		 *  定义实现类,重写方法,创建实现类对象,一步搞定
		 *  格式:
		 *    new 接口或者父类(){
		 *       重写抽象方法
		 *    };
		 *    从 new开始,到分号结束
		 *    创建了接口的实现类的对象
		 */
		new Smoking(){
			public void smoking(){
				System.out.println("人在吸烟");
			}
		}.smoking();
	}
}
```

### 7. 匿名内部类_2
* A: 举个栗子

```java
	public abstract class Animal {
		public abstract void eat();
		public abstract void sleep();
	}

测试代码
/*
 *    new Animal(){
			public void eat(){
				System.out.println("在吃饭");
			} 
			public void sleep(){
				System.out.println("在睡觉");
			}
		 };
	以上代码,就是Animal的子类的对象
	多态性, 父类引用 = 子类的对象

 */
public class Test2 {
	public static void main(String[] args) {
		Animal a= new Animal(){
			public void eat(){
				System.out.println("在吃饭");
			} 
			public void sleep(){
				System.out.println("在睡觉");
			}
		 };
		 a.eat();
		 a.sleep();
	}
}
```

### 8. 补充--包的概念 
* A: 概念
	* java的包，其实就是我们电脑系统中的文件夹，包里存放的是类文件。
	* 当类文件很多的时候，通常我们会采用多个包进行存放管理他们，这种方式称为分包管理。
	* 在项目中，我们将相同功能的类放到一个包中，方便管理。并且日常项目的分工也是以包作为边界。
	* 类中声明的包必须与实际`class`文件所在的文件夹情况相一致，即类声明在a包下，则生成的`.class`文件必须在a文件夹下，否则，程序运行时会找不到类。

* B: 声明格式
	* 通常使用公司网址反写，可以有多层包，包名采用全部小写字母，多层包之间用`.`连接
	* 类中包的声明格式： 
		* `package 包名.包名.包名…;`
		* 如：百度网址`baidu.com`那么网址反写就为`com.baidu`
		* 注意：声明包的语句，必须写在程序有效代码的第一行（注释不算）
	* 代码演示：

```java
package com.baidu; //包的声明，必须在有效代码的第一行

import java.util.Scanner;
import java.util.Random;

public class Demo {}
```

* C: 包的访问
	* 在访问类时，为了能够找到该类，必须使用含有包名的类全名（包名.类名）。
	* `包名.包名….类名`
	* 如： 
		* `java.util.Scanner`
		* `java.util.Random`
	* 带有包的类，创建对象格式：`包名.类名 变量名 = new包名.类名();`
	* 前提：包的访问与访问权限密切相关，这里以一般情况来说，即类用public修饰的情况。

	* 类的简化访问
	* 当我们要使用一个类时，这个类与当前程序在同一个包中（即同一个文件夹中），或者这个类是`java.lang`包中的类时通常可以省略掉包名，直接使用该类。
		* 如：`com.baidu`包中有两个类，`PersonTest`类，与`Person`类。我们在`PersonTest`类中，访问`Person`类时，由于是同一个包下，访问时可以省略包名，即直接通过类名访问 `Person`。
		* `类名 变量名 = new类名();`
		* `Person p = new Person();`

	* 当我们要使用的类，与当前程序不在同一个包中（即不同文件夹中），要访问的类必须用public修饰才可访问。
	
### 9. 导入包
* 我们每次使用类时，都需要写很长的包名。很麻烦，我们可以通过import导包的方式来简化。可以通过导包的方式使用该类，可以避免使用全类名编写（即，包类.类名）。
* 导包的格式：
	* `import 包名.类名;`
* 当程序导入指定的包后，使用类时，就可以简化了。演示如下

```java
//导入包前的方式
//创建对象
java.util.Random r1 = new java.util.Random();
java.util.Random r2 = new java.util.Random();
java.util.Scanner sc1 = new java.util.Scanner(System.in);
java.util.Scanner sc2 = new java.util.Scanner(System.in);

//导入包后的方式
import java.util.Random;
import java.util.Scanner;
//创建对象
Random r1 = new Random();
Random r2 = new Random();
Scanner sc1 = new Scanner(System.in);
Scanner sc2 = new Scanner(System.in);
```

**import导包代码书写的位置：在声明包package后，定义所有类class前，使用导包import包名.包名.类名;**

### 10. 权限修饰符
* A 权限修饰符有哪些
	* 在Java中提供了四种访问权限，使用不同的访问权限时，被修饰的内容会有不同的访问权限，
	* 以下表来说明不同权限的访问能力：

```
		              public			protected	  default		private
同一类中                    √               √        √           √
同一包中(子类与无关类)       √               √         √
不同包的子类                √             √
不同包中的无关类            √		
```

* B: 小结
	* 归纳一下：在日常开发过程中，编写的类、方法、成员变量的访问
	* 要想仅能在本类中访问使用private修饰；
	* 要想本包中的类都可以访问不加修饰符即可；
	* 要想本包中的类与其他包中的子类可以访问使用protected修饰
	* 要想所有包中的所有类都可以访问使用public修饰。
	* **注意：果类用public修饰，则类名必须与文件名相同。一个文件中只能有一个public修饰的类。**

### 11. 代码块
* A: 概述:
	* 程序中用大括号括起来的代码叫代码块
* B: 分类
	* 局部代码块  
	* 构造代码块  
	* 静态代码块  
	* 同步代码块
* C 局部代码块:
	* 局部代码块是定义在方法或语句中
	* 特点：
		* 以”{}”划定的代码区域，此时只需要关注作用域的不同即可
		* 方法和类都是以代码块的方式划定边界的

```java
class Demo{
	public static void main(String[] args)	{
		{
				 int x = 1;
				 System.out.println("普通代码块" + x);
		}
		int x = 99;
		System.out.println("代码块之外" + x);
	}
}


结果：
	普通代码块1
	代码块之外99
	局部代码块作用:可以限定变量的声明周期.
```

* D: 构造代码块
	* 构造代码块是定义在类中成员位置的代码块
	* 特点：
		* 优先于构造方法执行，构造代码块用于执行所有对象均需要的初始化动作
		* 每创建一个对象均会执行一次构造代码块。

```java
public class Person {
	private String name;
	private int age;
	
	 //构造代码块
	{
		System.out.println("构造代码块执行了");
	}
	Person(){
		System.out.println("Person无参数的构造函数执行");
	}
	Person(int age){
		this.age = age;
		System.out.println("Person（age）参数的构造函数执行");
	}
}
class PersonDemo{
	public static void main(String[] args)	{
		Person p = new Person();
		Person p1 = new Person(23);
	}
}
```

* E: 静态代码块
	* 静态代码块是定义在成员位置，使用static修饰的代码块。
	* 特点：
		* 它优先于主方法执行、优先于构造代码块执行，当以任意形式第一次使用到该类时执行。
		* 该类不管创建多少对象，静态代码块只执行一次。
		* 可用于给静态变量赋值，用来给类进行初始化。

```java
public class Person {
	private String name;
	private int age;
	 //静态代码块
	static{
		System.out.println("静态代码块执行了");
	}
}
```


<br>

转载请注明原地址：[wonderheng的博客](http://www.wonderheng.top) » [点击阅读原文](http://www.wonderheng.top/2018/02/java%E4%B8%AD%E7%9A%84%E5%8C%BF%E5%90%8D%E5%AF%B9%E8%B1%A1%E5%8F%8A%E5%8C%85%E4%B8%8E%E4%BB%A3%E7%A0%81%E5%9D%97/),谢谢！