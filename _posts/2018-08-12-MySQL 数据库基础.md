---
layout: post
title: 初始MySQL
date: 2018-08-12
tag: MySQL 
---  

# MySQL 数据库基础

### MySQL的基本使用

* 连接到MySQL
`mysql [-h 主机名或IP地址] -u 用户名 -p`
	* **注意：如果没有写 -h 127.0.0.1 默认是连接本地**
* MySQL服务关闭与启动
* 数据库服务器、数据库和表的关系
	* 所谓安装数据库服务器，只是在机器上安装了一个数据库管理系统程序，这个管理程序可以管理多个数据库，一般开发人员会针对每一个应用创建一个数据库。
	* 为保存应用中实体的数据，一般会在数据库中创建多个表，以保存程序中实体的数据。
	* 数据库服务器、数据库和表的关系 如下图：
<div align="center">
	<img src="/images/posts/MySQL/1.png" height="553" width="1354">  
</div>
* 数据在数据库中的存储方式

<div align="center">
	<img src="/images/posts/MySQL/2.png" height="431" width="1200">  
</div>

### SQL分类

* DDL数据定义语言，用来维护存储数据的结构
	* 代表指令: `create, drop, salter`
* DML数据操作语言，用来对数据操作
	* 代表指令： `insert，delete，update`
	* DML中又单独分了一个DQL，数据查询语言，代表指令： `select`
* DCL数据控制语言，主要负责权限管理和事务
	* 代表指令： `grant，revoke，commit`



### 数据库命令

* 创建数据库
	* create database helloworld;
* 使用数据库
	* use helloworld;
* 创建数据库表
	* create table student(id int,name varchar(30),gender varchar(30));
* 表中插入数据
	* insert into student (id ,name,gender) values (1,'张三','男');
* 查询表中数据
	* select * from student;
 
# 库的操作

### 创建数据库

* 语法：
`CREATE DATABASE [IF NOT EXISTS] db_name [create_specification [, create_specification] ...]`
* 注：
	* 大写的表示关键字
	* [] 是可选项
	* CHARACTER SET: 指定数据库采用的字符集
	* COLLATE: 指定数据库字符集的校验规则
	* 当我们创建数据库没有指定字符集和校验规则时，系统使用默认，字符集：`utf8`，校验规则是：`utf8_general_ ci`

* 例：
	* 创建一个使用utf字符集，并带校对规则的test数据库

	`mysql> create database test charset=utf8 collate utf8_general_ci;`

### 字符集和校验规则

*  查看系统默认字符集以及校验规则

	* `show variables like 'character_set_database';`
	* `show variables like 'collation_database';`

* 查看数据库支持的字符集校验规则

	* `select collation`

### 操纵数据库

*  查看数据库

	`show databases;`

	* 举个栗子
```
	mysql> show databases;
	+--------------------+
	| Database           |
	+--------------------+
	| information_schema |
	| mysql              |
	| test               |
	+--------------------+
	3 rows in set (0.00 sec)	
```

*  显示数据库创建语句

	`show create database 数据库名；`

	* 举个栗子

```
	mysql> show create database mytest;
	+----------+-----------------------------------------------------------------+
	| Database | Create Database                                                 |
	+----------+-----------------------------------------------------------------+
	| mytest | CREATE DATABASE `mytest` /*!40100 DEFAULT CHARACTER SET utf8 */   |
	+----------+-----------------------------------------------------------------+
```

**注：**

1.MySQL 建议我们关键字使用大写，但是不是必须的。<br>
2.若数据库名刚好是关键字，则用反引号` `括起来<br>
3./ * !40100 default.... * /这个不是注释，表示当前mysql版本大于4.01版本，就执行这句话

* 修改数据库

	* `ALTER DATABASE [IF EXISTS] db_name [alter_spacification [,alter_spacification]...]`

	* 栗子：将mytest数据库字符集改成gbk

```
	mysql> alter database mytest charset=gbk;
	Query OK, 1 row affected (0.00 sec)

	mysql> show create database mytest;
	+----------+----------------------------------------------------------------+
	| Database | Create Database                                                |
	+----------+----------------------------------------------------------------+
	| mytest | CREATE DATABASE `mytest` /*!40100 DEFAULT CHARACTER SET gbk */   |
	+----------+----------------------------------------------------------------+
```
* 删除数据库

	* `DROP DATABASE [IF EXISTS] db_ name;`

	* 注：不要随意删除数据库，执行删除之后：
		* 数据库内部看不到对应的数据库
		* 对应的数据库文件夹被删除，级联删除，里面的数据表全部被删

* 备份和恢复数据库
	* 备份：
		* 语法：`C:\Users\WonderHeng\Desktop> mysqldump -u root -p 密码 -B 数据库名 > 数据库备份存储的文件路径`
		* 示栗：将mytest库备份到文件
			* `C:\Users\WonderHeng\Desktop> mysqldump -u root -p mytest > ./mytest.sql`
		* 这时，可以打开看看mytest.sql文件里的内容，其实把我们整个创建数据库，建表，导入数据的语句都装载这个文件中
	* 还原：
		* `mysql> source /root/Desktop/mytest.sql;`
	* 补充：
		* 备份某数据库中的某些表
			* `C:\Users\WonderHeng\Desktop> mysqldump -u root -p密码 数据库名 表名1 表名2 > ./mytest.sql`
		* 同时备份多个数据库
			* `C:\Users\WonderHeng\Desktop> mysqldump -u root -p密码 -B 数据库名1 数据库名2 ... > 数据库存放路径`
		* 如果我们备份一个数据库时，没有带上-B参数，在恢复数据库时，需要再创建空数据库，然后使用数据库，再使用source来还原。

*  查看连接情况
	* 语法：`show processlist;`
	* 这条指令可以告诉我们当前有哪些用户连接到我们的MySQL，如果查出某个用户不是你正常登陆的，很有可能你的数据库被人入侵了。以后大家发现自己数据库比较慢时，可以用这个指令来看看数据库连接情况。
	* 若发现确有入侵者，可用`kill id号；`断开其连接。
	* 栗子：
```
	mysql> show processlist;
	+----+------+-----------+------+---------+------+-------+------------------+
	| Id | User | Host      | db   | Command | Time | State | Info             |
	+----+------+-----------+------+---------+------+-------+------------------+
	| 2  | root | localhost | test | Sleep   | 1386 |       | NULL             |
	| 3  | root | localhost | NULL | Query   | 0    | NULL  | show processlist |
	+----+------+-----------+------+---------+------+-------+------------------+
```

### 表的操作

* 创建表
```
CREATE TABLE table_name (
field1 datatype,
field2 datatype,
field3 datatype
) character set 字符集 collate 校验规则 engine 存储引擎;
```
	* 说明：
		* field 表示列名
		* datatype 表示列的类型
		* character set 字符集，如果没有指定字符集，则以所在数据库的字符集为准
		* collate校验规则，如果没有指定校验规则，则以所在数据库的校验规则为准

* 修改表
	* 在项目实际开发中，经常修改某个表的结构，比如字段名字，字段大小，字段类型，表的字符集类型，表的存储引擎等等。我们还有需求，添加字段，删除字段等等。这时我们就需要修改表。

```
-- 增加字段
ALTER TABLE tablename ADD (column datatype [DEFAULT expr][,column datatype]...);
-- 修改字段属性
ALTER TABLE tablename MODIfy (column datatype [DEFAULT expr][,column datatype]...);
-- 删除字段
ALTER TABLE tablename DROP (column);
```

<br>

转载请注明原地址：[wonderheng的博客](http://www.wonderheng.top) » [点击阅读原文](http://www.wonderheng.top/2017/12/%E6%B5%85%E8%B0%88%E6%8E%92%E5%BA%8F-%E5%86%92%E6%B3%A1%E6%8E%92%E5%BA%8F/),谢谢！